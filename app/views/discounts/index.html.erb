<div class="flex items-center justify-between">
  <div>
    <div class="text-sm text-slate-500">アプリ共通の割引を管理します。</div>
    <h1 class="mt-1 text-2xl font-semibold text-slate-900">割引一覧</h1>
  </div>
  <%= link_to "割引を追加", new_discount_path, class: "inline-flex items-center rounded-lg bg-sky-600 px-4 py-2 text-sm font-semibold text-white shadow transition hover:bg-sky-500" %>
</div>

<div class="mt-6 overflow-hidden rounded-xl border border-slate-200 bg-white shadow">
  <table class="min-w-full divide-y divide-slate-200 text-sm">
    <thead class="bg-slate-50 text-left text-xs font-semibold uppercase tracking-wider text-slate-600">
      <tr>
        <th class="px-4 py-3">順序</th>
        <th class="px-4 py-3">名称</th>
        <th class="px-4 py-3">カテゴリ / 範囲</th>
        <th class="px-4 py-3">方式 / 値</th>
        <th class="px-4 py-3">併用 / 状態</th>
        <th class="px-4 py-3 text-right">操作</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-slate-100 bg-white">
      <% @discounts.each do |discount| %>
        <tr class="hover:bg-slate-50">
          <td class="px-4 py-3 font-mono text-slate-500"><%= discount.priority %></td>
          <td class="px-4 py-3 font-semibold text-slate-800"><%= discount.name %></td>
          <td class="px-4 py-3 text-slate-600">
            <div class="flex flex-col text-xs">
              <span><%= discount.category_label %></span>
              <span class="text-slate-400">対象: <%= discount.scope_label %></span>
            </div>
          </td>
          <td class="px-4 py-3 text-slate-600">
            <div class="flex flex-col text-xs">
              <span><%= discount.kind_percentage? ? "割合" : discount.kind_fixed? ? "固定額" : "特典" %></span>
              <span class="text-slate-400">
                <% if discount.kind_percentage? %>
                  <%= discount.value %>%
                <% elsif discount.kind_fixed? %>
                  ¥<%= number_with_delimiter(discount.value) %>
                <% else %>
                  - 
                <% end %>
              </span>
            </div>
          </td>
          <td class="px-4 py-3 text-slate-600">
            <div class="flex flex-col gap-1">
              <span class="inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-semibold text-slate-600"><%= discount.stacking_label %></span>
              <% status = discount.status %>
              <% status_color =
                   case status
                   when :active then "bg-emerald-100 text-emerald-700"
                   when :upcoming then "bg-amber-100 text-amber-700"
                   when :expired then "bg-rose-100 text-rose-700"
                   else "bg-slate-200 text-slate-600"
                   end %>
              <span class="inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-semibold <%= status_color %>"><%= discount.status_label %></span>
            </div>
          </td>
          <td class="px-4 py-3 text-right text-xs font-semibold text-slate-500">
            <div class="flex justify-end gap-3">
              <%= link_to "詳細", discount, class: "text-slate-500 hover:text-slate-700" %>
              <%= link_to "編集", edit_discount_path(discount), class: "text-sky-600 hover:text-sky-500" %>
            </div>
          </td>
        </tr>
      <% end %>
      <% if @discounts.blank? %>
        <tr>
          <td colspan="6" class="px-4 py-6 text-center text-sm text-slate-500">登録されている割引はありません。</td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
